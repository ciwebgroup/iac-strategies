# =============================================================================
# WORDPRESS FARM INFRASTRUCTURE - ENVIRONMENT VARIABLES
# =============================================================================
# Copy this file to .env and fill in your actual values
# Never commit .env to version control!
# =============================================================================

# =============================================================================
# CLOUD PROVIDER CREDENTIALS
# =============================================================================

# DigitalOcean API Token (read/write access)
# Generate at: https://cloud.digitalocean.com/account/api/tokens
DO_API_TOKEN=dop_v1_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# DigitalOcean Spaces (S3-compatible storage)
DO_SPACES_ACCESS_KEY=DO00XXXXXXXXXXXXXXXXXXXX
DO_SPACES_SECRET_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
DO_SPACES_REGION=nyc3
DO_SPACES_ENDPOINT=https://nyc3.digitaloceanspaces.com

# Spaces Buckets
DO_SPACES_BUCKET=wp-farm-backups      # For backups
S3_MEDIA_BUCKET=wp-farm-media         # For WordPress media uploads
S3_CDN_DOMAIN=cdn.yourdomain.com      # DO Spaces CDN endpoint

# S3 Media Offload Configuration (Optional - Phase 2 optimization)
S3_MEDIA_ENABLED=false                # Set to true to enable S3 offload
S3_MEDIA_PLUGIN=amazon-s3-and-cloudfront  # WP Offload Media plugin
S3_REMOVE_LOCAL_FILES=true            # Delete local files after S3 upload
S3_SERVE_FROM_CDN=true                # Serve media from CDN
S3_PER_SITE_BUCKET=false              # false = shared bucket, true = bucket per site

# DigitalOcean Floating IPs (optional - for HA)
DO_FLOATING_IP_1=203.0.113.10
DO_FLOATING_IP_2=203.0.113.11

# =============================================================================
# PROXMOX VIRTUAL ENVIRONMENT (PVE)
# =============================================================================

# Proxmox API Credentials
PVE_API_URL=https://proxmox.yourdomain.com:8006/api2/json
PVE_API_USER=root@pam
PVE_API_TOKEN_ID=terraform
PVE_API_TOKEN_SECRET=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx

# Proxmox Cluster Configuration
PVE_CLUSTER_NAME=wp-farm-cluster
PVE_NODE_01=pve-node-01
PVE_NODE_02=pve-node-02
PVE_NODE_03=pve-node-03

# CephFS Configuration
CEPH_MON_HOST=10.0.5.10,10.0.5.11,10.0.5.12
CEPH_CLIENT_ID=admin
CEPH_CLIENT_KEY=AQDxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CEPH_FS_NAME=cephfs
CEPH_POOL_NAME=cephfs_data

# =============================================================================
# CLOUDFLARE CDN & DNS
# =============================================================================

# Cloudflare API Token (DNS Edit permissions)
# Generate at: https://dash.cloudflare.com/profile/api-tokens
CF_API_TOKEN=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CF_API_EMAIL=admin@yourdomain.com
CF_ZONE_ID=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CF_ACCOUNT_ID=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Cloudflare Tunnel (optional - for secure origin)
CF_TUNNEL_TOKEN=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# =============================================================================
# DOMAIN & SSL
# =============================================================================

# Primary domain for infrastructure
DOMAIN=yourdomain.com

# Let's Encrypt Email (for SSL certificates)
LETSENCRYPT_EMAIL=admin@yourdomain.com

# Wildcard domain support
WILDCARD_DOMAIN=*.yourdomain.com

# =============================================================================
# SSH & ACCESS
# =============================================================================

# SSH Key Name (must exist in DigitalOcean)
DO_SSH_KEY_NAME=wp-farm-deploy-key

# SSH Key Fingerprint
DO_SSH_KEY_FINGERPRINT=xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx

# Bastion Host
BASTION_HOST=bastion.yourdomain.com
BASTION_USER=deploy
BASTION_PORT=22

# =============================================================================
# DOCKER SWARM CONFIGURATION
# =============================================================================

# Swarm Manager IPs (comma-separated)
SWARM_MANAGER_IPS=10.0.1.10,10.0.1.11,10.0.1.12

# Swarm Join Tokens (generated during init)
SWARM_MANAGER_TOKEN=SWMTKN-1-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx-xxxxxxxxxxxxxxxxxxxxxx
SWARM_WORKER_TOKEN=SWMTKN-1-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx-xxxxxxxxxxxxxxxxxxxxxx

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# MariaDB Root Password
MYSQL_ROOT_PASSWORD=CHANGE_ME_STRONG_PASSWORD_HERE_32_CHARS

# ProxySQL Admin Credentials
PROXYSQL_ADMIN_USER=proxysql-admin
PROXYSQL_ADMIN_PASSWORD=CHANGE_ME_STRONG_PASSWORD

# Database Backup User
DB_BACKUP_USER=backup
DB_BACKUP_PASSWORD=CHANGE_ME_STRONG_PASSWORD

# Galera Cluster Configuration
GALERA_CLUSTER_NAME=wp-farm-galera
GALERA_CLUSTER_ADDRESS=gcomm://10.0.3.10,10.0.3.11,10.0.3.12
GALERA_SST_USER=sst_user
GALERA_SST_PASSWORD=CHANGE_ME_STRONG_PASSWORD

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis Password (for object cache)
REDIS_PASSWORD=CHANGE_ME_STRONG_PASSWORD_32_CHARS

# Redis Sentinel Configuration
REDIS_SENTINEL_QUORUM=2
REDIS_SENTINEL_DOWN_AFTER=5000
REDIS_SENTINEL_FAILOVER_TIMEOUT=60000

# =============================================================================
# VARNISH CACHE CONFIGURATION
# =============================================================================

# Varnish Memory Allocation (per node) - Optimized for 8GB cache nodes
VARNISH_MEMORY=4G

# Varnish Secret (for admin access)
VARNISH_SECRET=CHANGE_ME_RANDOM_SECRET_STRING

# Cache TTL (seconds)
VARNISH_DEFAULT_TTL=3600
VARNISH_GRACE_PERIOD=600

# =============================================================================
# SECURITY & WAF
# =============================================================================

# CrowdSec Configuration
CROWDSEC_LAPI_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
CROWDSEC_ENROLL_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Traefik Dashboard Credentials
TRAEFIK_DASHBOARD_USER=admin
TRAEFIK_DASHBOARD_PASSWORD_HASH=$apr1$xxxxxxxxxxxxxxxxxx

# Basic Auth for sensitive endpoints
BASIC_AUTH_USER=admin
BASIC_AUTH_PASSWORD_HASH=$apr1$xxxxxxxxxxxxxxxxxx

# =============================================================================
# OBSERVABILITY STACK (LGTM)
# =============================================================================

# Grafana Admin Credentials
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=CHANGE_ME_STRONG_PASSWORD

# Grafana OAuth (optional)
GRAFANA_AUTH_GITHUB_CLIENT_ID=xxxxxxxxxxxxxxxxxxxx
GRAFANA_AUTH_GITHUB_CLIENT_SECRET=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
GRAFANA_AUTH_GITHUB_ALLOWED_ORGS=your-org-name

# Prometheus Configuration
PROMETHEUS_RETENTION=30d
PROMETHEUS_SCRAPE_INTERVAL=15s

# Loki Configuration
LOKI_RETENTION_PERIOD=720h
LOKI_MAX_QUERY_LENGTH=12000h

# =============================================================================
# ALERTING CONFIGURATION
# =============================================================================

# Slack Alerting
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR_WORKSPACE_ID/YOUR_CHANNEL_ID/YOUR_SECRET_TOKEN
SLACK_CHANNEL=#wordpress-farm-alerts
SLACK_USERNAME=WP-Farm-Monitor
SLACK_ICON_EMOJI=:warning:

# Email Alerting (SendGrid)
SENDGRID_API_KEY=SG.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
SENDGRID_FROM_EMAIL=alerts@yourdomain.com
SENDGRID_FROM_NAME=WordPress Farm Alerts
SENDGRID_TO_EMAIL=ops-team@yourdomain.com,admin@yourdomain.com

# SMS Alerting (Twilio)
TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_AUTH_TOKEN=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_FROM_NUMBER=+15551234567
TWILIO_TO_NUMBERS=+15559876543,+15555555555

# PagerDuty Integration (optional)
PAGERDUTY_INTEGRATION_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
PAGERDUTY_SERVICE_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Alert Thresholds
ALERT_CPU_THRESHOLD=85
ALERT_MEMORY_THRESHOLD=90
ALERT_DISK_THRESHOLD=85
ALERT_RESPONSE_TIME_THRESHOLD=2000
ALERT_ERROR_RATE_THRESHOLD=5

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================

# Backup Schedule
BACKUP_TIME_DB="02:00"           # Database backups at 2 AM
BACKUP_TIME_FILES="03:00"        # WordPress file backups at 3 AM
BACKUP_TIME_CLEANUP="04:00"      # Cleanup at 4 AM

# Backup Retention (Smart 3-Tier Policy)
KEEP_ALL_DAYS=14                 # Keep ALL backups for 14 days
KEEP_WEEKLY_START_DAY=15         # Weekly retention starts at day 15
KEEP_WEEKLY_END_DAY=180          # Weekly retention ends at day 180
KEEP_WEEKLY_DAY=sunday           # Keep Sunday backups only
KEEP_MONTHLY_START_DAY=181       # Monthly retention starts at day 181
KEEP_MONTHLY_END_DAY=365         # Monthly retention ends at day 365
KEEP_MONTHLY_DAY=1               # Keep 1st of month backups only
MAX_AGE_DAYS=365                 # Delete backups older than 1 year

# Backup Encryption
BACKUP_ENCRYPTION_ENABLED=true
BACKUP_GPG_KEY_ID=xxxxxxxxxxxxxxxx
BACKUP_GPG_PASSPHRASE=CHANGE_ME_STRONG_PASSPHRASE

# Backup Compression
BACKUP_COMPRESSION=gzip

# Backup Performance
BACKUP_PARALLEL_JOBS=4           # Backup 4 sites in parallel

# =============================================================================
# WORDPRESS DEFAULTS
# =============================================================================

# Default WordPress Admin
WP_ADMIN_USER=wpadmin
WP_ADMIN_EMAIL=wordpress@yourdomain.com
WP_DEFAULT_PASSWORD=CHANGE_ME_STRONG_PASSWORD

# WordPress Salts (generate at: https://api.wordpress.org/secret-key/1.1/salt/)
WP_AUTH_KEY='put your unique phrase here'
WP_SECURE_AUTH_KEY='put your unique phrase here'
WP_LOGGED_IN_KEY='put your unique phrase here'
WP_NONCE_KEY='put your unique phrase here'
WP_AUTH_SALT='put your unique phrase here'
WP_SECURE_AUTH_SALT='put your unique phrase here'
WP_LOGGED_IN_SALT='put your unique phrase here'
WP_NONCE_SALT='put your unique phrase here'

# =============================================================================
# PORTAINER CONFIGURATION
# =============================================================================

# Portainer Admin Password
PORTAINER_ADMIN_PASSWORD=CHANGE_ME_STRONG_PASSWORD

# Portainer Edge Key (for edge agents)
PORTAINER_EDGE_ID=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
PORTAINER_EDGE_KEY=aHR0cHM6Ly9wb3J0YWluZXIueW91cmRvbWFpbi5jb206OTQ0M3xleUp3SWpvaU1UQTNOVFF4TlRNMk1UWXhORFk0T1RBaUxDSnpJam94ZlE9PXw1

# =============================================================================
# CONTRACTOR ACCESS & AUTHENTIK SSO
# =============================================================================

# Authentik SSO (for contractor authentication)
AUTHENTIK_URL=https://authentik.yourdomain.com
AUTHENTIK_API_TOKEN=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
AUTHENTIK_COOKIE_SECRET=CHANGE_ME_RANDOM_SECRET_32_CHARS
AUTHENTIK_LDAP_HOST=ldap://authentik.yourdomain.com:389

# Contractor Portal API
API_SESSION_SECRET=CHANGE_ME_RANDOM_SECRET_32_CHARS

# FileBrowser Configuration
FILEBROWSER_ENABLED=true
FILEBROWSER_DATABASE=/database/filebrowser.db

# Code Server (Web-based IDE - optional)
CODE_SERVER_PASSWORD=CHANGE_ME_STRONG_PASSWORD
CODE_SERVER_ENABLED=false  # Set to true to enable

# Registry Secret (Docker private registry)
REGISTRY_SECRET=CHANGE_ME_RANDOM_SECRET

# Contractor SFTP Configuration
SFTP_PORT=2222
SFTP_ENABLED=true

# =============================================================================
# NETWORK CONFIGURATION
# =============================================================================

# VPC Network
VPC_CIDR=10.0.0.0/16

# Subnet Allocations
SUBNET_MANAGERS=10.0.1.0/24
SUBNET_WORKERS=10.0.2.0/23
SUBNET_DATABASE=10.0.3.0/24
SUBNET_STORAGE=10.0.4.0/24
SUBNET_CACHE=10.0.5.0/24
SUBNET_OBSERVABILITY=10.0.6.0/24

# Docker Network Subnets
DOCKER_NETWORK_TRAEFIK_PUBLIC=172.20.0.0/16
DOCKER_NETWORK_WORDPRESS=172.21.0.0/16
DOCKER_NETWORK_DATABASE=172.22.0.0/16
DOCKER_NETWORK_STORAGE=172.23.0.0/16
DOCKER_NETWORK_CACHE=172.24.0.0/16
DOCKER_NETWORK_OBSERVABILITY=172.25.0.0/16
DOCKER_NETWORK_CROWDSEC=172.26.0.0/16
DOCKER_NETWORK_MANAGEMENT=172.27.0.0/16

# =============================================================================
# RESOURCE LIMITS
# =============================================================================

# Manager Node Specs
MANAGER_NODE_SIZE=s-8vcpu-16gb
MANAGER_NODE_COUNT=3

# Worker Node Specs
WORKER_NODE_SIZE=s-8vcpu-16gb
WORKER_NODE_COUNT=20

# Cache Node Specs (Optimized: 8GB sufficient for Varnish + Redis)
CACHE_NODE_SIZE=s-4vcpu-8gb
CACHE_NODE_COUNT=3

# Database Node Specs
DB_NODE_SIZE=s-8vcpu-16gb
DB_NODE_COUNT=3

# Storage Node Specs (CephFS)
STORAGE_NODE_SIZE=s-8vcpu-16gb-amd
STORAGE_NODE_COUNT=3
STORAGE_VOLUME_SIZE=1000  # GB per node

# Monitoring Node Specs
MONITOR_NODE_SIZE=s-8vcpu-16gb
MONITOR_NODE_COUNT=2

# =============================================================================
# DEPLOYMENT CONFIGURATION
# =============================================================================

# Deployment Region
DO_REGION=nyc3

# Deployment Tags
DEPLOYMENT_ENV=production
DEPLOYMENT_PROJECT=wordpress-farm
DEPLOYMENT_VERSION=1.0.0

# Terraform State
TF_STATE_BACKEND=s3
TF_STATE_BUCKET=wp-farm-terraform-state
TF_STATE_KEY=infrastructure/terraform.tfstate
TF_STATE_REGION=nyc3
TF_STATE_LOCK_TABLE=terraform-locks

# =============================================================================
# LOGGING & MONITORING
# =============================================================================

# Log Level
LOG_LEVEL=info

# Metrics Retention
METRICS_RETENTION_DAYS=30

# Trace Sampling Rate (0.0 to 1.0)
TRACE_SAMPLING_RATE=0.1

# =============================================================================
# CONTRACTOR ACCESS & AUTHENTIK SSO
# =============================================================================

# Authentik SSO (for contractor authentication)
AUTHENTIK_URL=https://authentik.yourdomain.com
AUTHENTIK_API_TOKEN=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
AUTHENTIK_COOKIE_SECRET=CHANGE_ME_RANDOM_SECRET_32_CHARS
AUTHENTIK_LDAP_HOST=ldap://authentik.yourdomain.com:389

# Contractor Portal API
API_SESSION_SECRET=CHANGE_ME_RANDOM_SECRET_32_CHARS

# FileBrowser Configuration
FILEBROWSER_ENABLED=true
FILEBROWSER_DATABASE=/database/filebrowser.db

# Code Server (Web-based IDE - optional)
CODE_SERVER_PASSWORD=CHANGE_ME_STRONG_PASSWORD
CODE_SERVER_ENABLED=false  # Set to true to enable

# Registry Secret (Docker private registry)
REGISTRY_SECRET=CHANGE_ME_RANDOM_SECRET

# Contractor SFTP Configuration
SFTP_PORT=2222
SFTP_ENABLED=true

# =============================================================================
# OPTIONAL SERVICES
# =============================================================================

# Elasticsearch (for log indexing - optional)
ELASTICSEARCH_ENABLED=false
ELASTICSEARCH_URL=http://elasticsearch:9200
ELASTICSEARCH_USERNAME=elastic
ELASTICSEARCH_PASSWORD=CHANGE_ME

# Kafka (for event streaming - optional)
KAFKA_ENABLED=false
KAFKA_BROKERS=kafka-1:9092,kafka-2:9092,kafka-3:9092

# RabbitMQ (for job queues - optional)
RABBITMQ_ENABLED=false
RABBITMQ_URL=amqp://guest:guest@rabbitmq:5672/

# =============================================================================
# DEVELOPMENT & TESTING
# =============================================================================

# Debug Mode (never enable in production!)
DEBUG=false

# Development SSH Access
DEV_SSH_ALLOWED_IPS=203.0.113.0/24

# Testing Environment
TESTING_ENABLED=false
TESTING_DOMAIN=test.yourdomain.com

# =============================================================================
# NOTES
# =============================================================================
# 
# Password Requirements:
# - Minimum 32 characters for production
# - Use a password manager to generate secure passwords
# - Never reuse passwords across services
# - Rotate passwords every 90 days
#
# Security Best Practices:
# - Store this .env file securely (encrypted)
# - Use secrets management (Vault, AWS Secrets Manager, etc.)
# - Restrict file permissions: chmod 600 .env
# - Never commit .env to git (add to .gitignore)
# - Use different credentials for dev/staging/production
#
# Generate secure passwords:
# openssl rand -base64 32
# 
# Generate Traefik/htpasswd:
# htpasswd -nb admin your_password
#
# =============================================================================

